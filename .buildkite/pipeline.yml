steps:
  - label: "Install dependencies"
    command: yarn install
    key: install-dependencies
    plugins:
      - docker#v5.5.1:
          image: "node:latest"
          volumes:
            - "./:/app"
          workdir: /app

  - label: "Install Playwright"
    command: yarn playwright install
    key: install-playwright
    plugins:
      - docker#v5.5.1:
          image: "node:latest"
          volumes:
            - "./:/app"
          workdir: /app
    depends_on:
      - install-dependencies

  - label: "Build project"
    command: yarn build
    key: build
    plugins:
      - docker#v5.5.1:
          image: "node:latest"
          volumes:
            - "./:/app"
          workdir: /app
    depends_on:
      - install-playwright

  - label: "Run E2E tests"
    command: yarn e2e
    key: e2e-tests
    plugins:
      - docker#v5.5.1:
          image: "node:latest"
          volumes:
            - "./:/app"
          workdir: /app
    depends_on:
      - build
